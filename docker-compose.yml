services:
    bert-classifier:
        build: .
        container_name: bert-classifier
        ports:
            - '5000:5000'
        volumes:
            - ./app/uploads:/app/uploads
            - ./app/model:/app/model
        environment:
            - FLASK_ENV=development
            - USE_SAFETENSORS=True # Добавляем переменную окружения
        deploy:
            resources:
                limits:
                    memory: 4G # Увеличиваем память для BERT
        shm_size: 2gb
        restart: unless-stopped

        # Опционально: можно добавить Nginx для продакшена
        # nginx:
        #   image: nginx:alpine
        #   ports:
        #     - "80:80"
        #   volumes:
        #     - ./nginx.conf:/etc/nginx/conf.d/default.conf
        #   depends_on:
        #     - bert-classifier
